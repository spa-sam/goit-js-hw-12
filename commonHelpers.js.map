{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// опції для пошуку\nconst options = {\n  base: 'https://pixabay.com/api/',\n  key: '41493530-c71176b83a18405cd33ba2537',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n};\n\nlet page = 1;\nconst perPage = 40;\n\n// створюємо параметри для пошуку\nconst params = new URLSearchParams(options);\nconst BASE_URL = options.base;\n\nparams.set('page', page);\nparams.set('per_page', perPage);\n\n// створюємо розмітку для інформації про картинку\nfunction createInfoBlock(title, value) {\n  return `\n    <div class=\"info-block\">\n      <p>${title}</p>\n      <p>${value}</p>\n    </div>\n  `;\n}\n\n// створюємо розмітку для картинки\nfunction createImageCardMarkup({\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n    <a href=\"${largeImageURL}\" class=\"lightbox-image linkStyle\">\n      <div class=\"image-card cardStyle\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"imgStyle\" />\n        <div class=\"infoStyle\">\n          ${createInfoBlock('Likes', likes)}\n          ${createInfoBlock('Views', views)}\n          ${createInfoBlock('Comments', comments)}\n          ${createInfoBlock('Downloads', downloads)}\n        </div>\n      </div>\n    </a>\n  `;\n}\nconst lightbox = new SimpleLightbox('.lightbox-image', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// створюємо галерею\nfunction createGalleryElement(parentElement) {\n  const gallery = document.createElement('div');\n  gallery.className = 'gallery custom-gallery-style';\n  parentElement.appendChild(gallery);\n  return gallery;\n}\n\nconst container = document.querySelector('.container');\n// опції для повідомлень\nconst toastOptions = {\n  title: '',\n  message:\n    'Sorry, there are no images matching<br> your search query. Please try again!',\n  position: 'topRight',\n  backgroundColor: '#EF4040',\n  messageColor: '#FAFAFB',\n  theme: 'dark',\n  messageSize: '322px',\n};\n\n// створюємо елементи\nconst gallery =\n  document.querySelector('.gallery') || createGalleryElement(container);\nconst form = document.querySelector('form');\nconst input = document.querySelector('input');\n\nconst loader = document.createElement('div');\nloader.classList.add('loader-text');\nloader.style.display = 'none';\nloader.textContent = 'Loading images, please wait...';\n\n// Створюємо кнопку \"Load more\"\nlet loadMoreBtn = document.querySelector('.load-more-btn');\nif (!loadMoreBtn) {\n  loadMoreBtn = document.createElement('button');\n  loadMoreBtn.classList.add('load-more-btn');\n  loadMoreBtn.textContent = 'Load more';\n  loadMoreBtn.style.display = 'none';\n}\n// Створюємо контейнер для кнопки і загрузчика\nconst btnLoaderContainer = document.createElement('div');\nbtnLoaderContainer.classList.add('btn-loader-container');\nbtnLoaderContainer.appendChild(loadMoreBtn);\nbtnLoaderContainer.appendChild(loader);\nform.insertAdjacentElement('afterend', btnLoaderContainer);\n\nlet totalHits = 0; // загальна кількість картинок\nlet requestCount = 0; // лічильник запитів\n\n// функція для отримання даних\nasync function fetchData() {\n  try {\n    loader.style.display = 'block';\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    const data = response.data;\n    totalHits = data.totalHits; // зберігаємо totalHits\n    if (data.hits.length === 0) {\n      iziToast.warning(toastOptions);\n    } else {\n      loadMoreBtn.style.display = 'block';\n      data.hits.forEach(image => {\n        const markup = createImageCardMarkup(image);\n        gallery.insertAdjacentHTML('beforeend', markup);\n      });\n      // переносимо  контейнер з кнопкою і загрузчиком в кінець галереї\n      gallery.insertAdjacentElement('afterend', btnLoaderContainer);\n    }\n\n    lightbox.refresh();\n    loader.style.display = 'none';\n\n    requestCount++;\n\n    // Отримуємо першу карточку галереї\n    const card = document.querySelector('.image-card');\n    if (card && requestCount > 1) {\n      // якщо карточка і запитів більше одного\n      // Отримуємо висоту карточки\n      const cardHeight = card.getBoundingClientRect().height;\n      // Прокручуємо сторінку на дві висоти карточки\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    loader.style.display = 'none';\n    iziToast.error({\n      ...toastOptions,\n      message: 'An error occurred. Please try again later.',\n    });\n  }\n}\n\n//  пошук по формі\nform.addEventListener('submit', function (event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  loader.style.display = 'block';\n  loadMoreBtn.style.display = 'none';\n  params.set('page', 1);\n  const searchQuery = input.value.trim();\n  if (!searchQuery) {\n    loader.style.display = 'none';\n    iziToast.warning({\n      ...toastOptions,\n      message: 'Please enter your search query!',\n    });\n    return;\n  }\n  form.reset();\n  params.set('q', searchQuery);\n  requestCount = 0; // обнуляємо лічильник запитів\n  setTimeout(fetchData, 2000); // для демо завантаження\n});\n\n// Кнопка \"Load more\"\nloadMoreBtn.addEventListener('click', function () {\n  loadMoreBtn.style.display = 'none';\n  loader.style.display = 'block';\n  page++;\n  params.set('page', page);\n  setTimeout(fetchData, 2000); // для демо завантаження\n  if (page * perPage >= totalHits) {\n    loadMoreBtn.style.display = 'none';\n    loader.style.display = 'none';\n    iziToast.warning({\n      ...toastOptions,\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  }\n});\n"],"names":["options","page","perPage","params","BASE_URL","createInfoBlock","title","value","createImageCardMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","createGalleryElement","parentElement","gallery","container","toastOptions","form","input","loader","loadMoreBtn","btnLoaderContainer","totalHits","requestCount","fetchData","data","axios","iziToast","image","markup","card","cardHeight","error","event","searchQuery"],"mappings":"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"}